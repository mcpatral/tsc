parameters:
- name: notebookFolder
  type: string
- name: workingDirectory
  type: string

- name: condition
  displayName: Run conditions for task
  type: string
  default: ""

steps:
  - task: Bash@3
    displayName: 'Prepare notebooks for upload'
    ${{ if ne(parameters.condition, '') }}:
      condition: ${{ parameters.condition }}
    inputs:
      targetType: 'inline'
      script: |
        rm __init__.py
        find . -type d -name __pycache__ -exec rm -r {} \+

        for file in *.py; do
          mv -- "$file" "${file%%.py}"
        done
        echo "=============================================================================="
        echo "Notebooks list for upload:"
        echo "=============================================================================="
        ls -la ${{ parameters.workingDirectory }}/${{ parameters.notebookFolder }}
      workingDirectory: ${{ parameters.workingDirectory }}/${{ parameters.notebookFolder }}
